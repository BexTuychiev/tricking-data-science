
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4.2. Sklearn - neat tricks &#8212; Tricking Data Science</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.3. Model explainability" href="explainability.html" />
    <link rel="prev" title="4.1. Feature engineering" href="feature_engineering.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Tricking Data Science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    <no title>
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../pure_python/index.html">
   1. Pure Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../pure_python/strings.html">
     1.1. Strings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pure_python/dictionaries.html">
     1.2. Dictionaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pure_python/control_flow.html">
     1.3. Control flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pure_python/built_in.html">
     1.4. Built-in libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pure_python/utilities.html">
     1.5. Utility libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../data_manipulation/index.html">
   2. Data Manipulation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_manipulation/importing_data.html">
     2.1. Importing data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_manipulation/pandas_global.html">
     2.2. Pandas - neat tricks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_manipulation/datasets.html">
     2.3. Getting datasets in code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_manipulation/time_series.html">
     2.4. Time series data manipulation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../data_visualization/index.html">
   3. Data Visualization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_visualization/matplotlib_tricks.html">
     3.1. Matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_visualization/seaborn_tricks.html">
     3.2. Seaborn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_visualization/others.html">
     3.3. Other cool dataviz libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   4. Machine Learning
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="feature_engineering.html">
     4.1. Feature engineering
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     4.2. Sklearn - neat tricks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="explainability.html">
     4.3. Model explainability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="codeless_advice.html">
     4.4. Codeless advice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="subtle_tricks.html">
     4.5. Subtle tricks for ML
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensembling.html">
     4.6. Ensembling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="time_series.html">
     4.7. Time series forecasting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../mlops/index.html">
   5. MLops
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../mlops/data_version_control.html">
     5.1. Data version control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mlops/packaging.html">
     5.2. Packaging ML projects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mlops/deployment.html">
     5.3. Model deployment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mlops/git.html">
     5.4. Git
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ecosystem/index.html">
   6. Ecosystem
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ecosystem/jupyter_lab.html">
     6.1. JupyterLab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ecosystem/utilities.html">
     6.2. Utility libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../statistics/index.html">
   7. Statistics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../statistics/concepts.html">
     7.1. Statistics concepts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../statistics/numpy_tricks.html">
     7.2. Numpy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../nlp/index.html">
   8. Natural Language Processing (NLP)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../nlp/spaCy.html">
     8.1. spaCy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../gem_resources/index.html">
   9. Gem Resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../gem_resources/pure_python.html">
     9.1. Pure Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gem_resources/deep_learning.html">
     9.2. General deep learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gem_resources/statistics.html">
     9.3. Statistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gem_resources/math.html">
     9.4. Math
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gem_resources/datasets.html">
     9.5. Datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gem_resources/dataviz.html">
     9.6. Data visualization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gem_resources/mlops.html">
     9.7. MLOps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gem_resources/classic_ml.html">
     9.8. Classic ML
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gem_resources/command_line.html">
     9.9. Command line (CLI)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gem_resources/interpretable_ai.html">
     9.10. Explainable AI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gem_resources/nlp.html">
     9.11. Natural Language Processing (NLP)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../gem_resources/non-category.html">
     9.12. Arbitrary resources
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/BexTuychiev/tricking-data-science/master?urlpath=tree/./book/machine_learning/sklearn_general.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/BexTuychiev/tricking-data-science"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/BexTuychiev/tricking-data-science/issues/new?title=Issue%20on%20page%20%2Fbook/machine_learning/sklearn_general.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/book/machine_learning/sklearn_general.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-pipeline-and-make-column-transformer-shorter-pipelines">
   4.2.1.
   <code class="docutils literal notranslate">
    <span class="pre">
     make_pipeline
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     make_column_transformer
    </span>
   </code>
   - shorter pipelines
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#function-and-class-transformer-for-custom-preprocessing-steps">
   4.2.2. Function and class transformer for custom preprocessing steps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#choose-columns-automatically-with-make-column-selector">
   4.2.3. Choose columns automatically with make_column_selector
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#logistic-regression-on-multi-class-problems">
   4.2.4. Logistic Regression on multi-class problems?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confusionmatrix-display-for-better-confusion-matrix">
   4.2.5. ConfusionMatrix display for better confusion matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#text-representation-of-a-decision-tree">
   4.2.6. Text representation of a decision tree
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#default-rmse-in-sklearn">
   4.2.7. Default RMSE in Sklearn
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-decision-trees-in-sklearn">
   4.2.8. Plotting decision trees in Sklearn
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rule-of-thumb-for-fit-predict-fit-transform">
   4.2.9. Rule of thumb for fit/predict/fit_transform
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-difference-between-micro-macro-weighted-averages">
   4.2.10. The difference between micro, macro, weighted averages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-a-scorer-object-from-just-the-name">
   4.2.11. Getting a scorer object from just the name
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-all-scorer-s-names-in-sklearn">
   4.2.12. Get all scorerâ€™s names in Sklearn
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#displaying-roc-curve-without-generating-predictions">
   4.2.13. Displaying ROC Curve without generating predictions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#html-representation-of-an-sklearn-pipeline">
   4.2.14. HTML representation of an Sklearn pipeline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#displaying-precision-recall-curve-without-generating-predictions">
   4.2.15. Displaying Precision/Recall curve without generating predictions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#group-kfold">
   4.2.16. Group KFold
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#shuffle-cv">
   4.2.17. Shuffle CV
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Sklearn - neat tricks</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-pipeline-and-make-column-transformer-shorter-pipelines">
   4.2.1.
   <code class="docutils literal notranslate">
    <span class="pre">
     make_pipeline
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     make_column_transformer
    </span>
   </code>
   - shorter pipelines
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#function-and-class-transformer-for-custom-preprocessing-steps">
   4.2.2. Function and class transformer for custom preprocessing steps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#choose-columns-automatically-with-make-column-selector">
   4.2.3. Choose columns automatically with make_column_selector
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#logistic-regression-on-multi-class-problems">
   4.2.4. Logistic Regression on multi-class problems?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confusionmatrix-display-for-better-confusion-matrix">
   4.2.5. ConfusionMatrix display for better confusion matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#text-representation-of-a-decision-tree">
   4.2.6. Text representation of a decision tree
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#default-rmse-in-sklearn">
   4.2.7. Default RMSE in Sklearn
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-decision-trees-in-sklearn">
   4.2.8. Plotting decision trees in Sklearn
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rule-of-thumb-for-fit-predict-fit-transform">
   4.2.9. Rule of thumb for fit/predict/fit_transform
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-difference-between-micro-macro-weighted-averages">
   4.2.10. The difference between micro, macro, weighted averages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-a-scorer-object-from-just-the-name">
   4.2.11. Getting a scorer object from just the name
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-all-scorer-s-names-in-sklearn">
   4.2.12. Get all scorerâ€™s names in Sklearn
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#displaying-roc-curve-without-generating-predictions">
   4.2.13. Displaying ROC Curve without generating predictions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#html-representation-of-an-sklearn-pipeline">
   4.2.14. HTML representation of an Sklearn pipeline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#displaying-precision-recall-curve-without-generating-predictions">
   4.2.15. Displaying Precision/Recall curve without generating predictions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#group-kfold">
   4.2.16. Group KFold
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#shuffle-cv">
   4.2.17. Shuffle CV
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="sklearn-neat-tricks">
<h1><span class="section-number">4.2. </span>Sklearn - neat tricks<a class="headerlink" href="#sklearn-neat-tricks" title="Permalink to this headline">#</a></h1>
<section id="make-pipeline-and-make-column-transformer-shorter-pipelines">
<h2><span class="section-number">4.2.1. </span><code class="docutils literal notranslate"><span class="pre">make_pipeline</span></code> and <code class="docutils literal notranslate"><span class="pre">make_column_transformer</span></code> - shorter pipelines<a class="headerlink" href="#make-pipeline-and-make-column-transformer-shorter-pipelines" title="Permalink to this headline">#</a></h2>
<p>When your Sklearn pÄ±pelÄ±ne Ä±s fÄ±nÄ±shed, Ä±t can become quÄ±te humongous and unreadable.</p>
<p>UsÄ±ng <code class="docutils literal notranslate"><span class="pre">make_pipeline</span></code> and <code class="docutils literal notranslate"><span class="pre">make_column_transformer</span></code> can collapse all those Ä±nto a few lÄ±nesğŸ‘‡:</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -365px;
      "
    >
      <iframe width="1168" height="696" title="Code snippet - make_pipe_transformer" src="https://snappify.io/embed/1922052b-f090-4b65-9c29-8d297876b5ba" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="function-and-class-transformer-for-custom-preprocessing-steps">
<h2><span class="section-number">4.2.2. </span>Function and class transformer for custom preprocessing steps<a class="headerlink" href="#function-and-class-transformer-for-custom-preprocessing-steps" title="Permalink to this headline">#</a></h2>
<p>Sklearn transformers and pÄ±pelÄ±nes are powerful. They make preprocessÄ±ng data much easÄ±er. But Sklearn doesnâ€™t Ä±mplement transformers for all preprocessÄ±ng scenarÄ±os.</p>
<p>What Ä±f you need to Ä±nclude a custom feature engÄ±neerÄ±ng step? Or use a custom algorÄ±thm to encode categorÄ±cal values? If you canâ€™t add these steps to your pÄ±pelÄ±ne, the whole Ä±dea of atomÄ±c, flat pÄ±pelÄ±nes break down.</p>
<p>Fortunately, Sklearn provÄ±des classes lÄ±ke FunctÄ±onTransform to convert any preprocessÄ±ng functÄ±on to an Sklearn estÄ±mator and pass Ä±t Ä±nto a pÄ±pelÄ±ne.</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -350px;
      "
    >
      <iframe width="1124" height="616" title="Code snippet - sklearn_custom_transformer" src="https://snappify.io/embed/77b8c4e2-4b11-43fb-b1cd-772544759020" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="choose-columns-automatically-with-make-column-selector">
<h2><span class="section-number">4.2.3. </span>Choose columns automatically with make_column_selector<a class="headerlink" href="#choose-columns-automatically-with-make-column-selector" title="Permalink to this headline">#</a></h2>
<p>Sklearn has an automatic column selector - <code class="docutils literal notranslate"><span class="pre">make_column_selector</span></code>.</p>
<p>It can fÄ±lter columns by Ä±ncludÄ±ng or excludÄ±ng numerÄ±c/categorÄ±cal data types or Ä±t accepts a regex strÄ±ng Ä±f you want to capture more complex patterns.</p>
<p>Sklearn solutÄ±ons are always more elegant.</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -380px;
      "
    >
      <iframe width="1000" height="724" title="Code snippet - make_col_selector" src="https://snappify.io/embed/8232af30-fd7e-42cc-8969-9211f0ed672c" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="logistic-regression-on-multi-class-problems">
<h2><span class="section-number">4.2.4. </span>Logistic Regression on multi-class problems?<a class="headerlink" href="#logistic-regression-on-multi-class-problems" title="Permalink to this headline">#</a></h2>
<p>Ever wondered why logÄ±stÄ±c regressÄ±on works on multÄ±-class problems even though Ä±t Ä±s strÄ±ctly bÄ±nary classÄ±fÄ±catÄ±on algorÄ±thm?</p>
<p>There are three methods to modÄ±fy logÄ±stÄ±c regressÄ±on so that Ä±t works on mutlÄ±-class problems as well:</p>
<ol class="simple">
<li><p>One-vs-rest (OVR) or one-vs-all (OVA)
When logÄ±stÄ±c regressÄ±on Ä±s used wÄ±th OVR or OVA approaches on a multÄ±-class case, the problem Ä±s dÄ±vÄ±ded Ä±nto N bÄ±nary classÄ±fÄ±catÄ±on problems.</p></li>
</ol>
<p>If there are three classes (a, b, c), three LogReg models wÄ±ll be fÄ±t on a vs. not a, b vs. not b and c vs. not c problems. The results wÄ±ll be averaged (sÄ±mple or weÄ±ghted averages) to calculate a membershÄ±p probabÄ±lÄ±ty.</p>
<ol class="simple">
<li><p>One-vs-one (OVO)
In thÄ±s approach, n-class multÄ±-class problem Ä±s dÄ±vÄ±ded Ä±nto n*(n-1)/2 bÄ±nary classÄ±fÄ±catÄ±on problems. The results are averaged Ä±n the same manner. ThÄ±s Ä±s the less popular approach as Ä±t Ä±s computatÄ±on-heavy when you have many classes Ä±n the target.</p></li>
<li><p>MultÄ±nomÄ±al logÄ±stÄ±c regressÄ±on
By changÄ±ng the loss functÄ±on from log loss to cross-entropy loss, we get a multÄ±nomÄ±al logÄ±stÄ±c regressÄ±on model that can calculate membershÄ±p probabÄ±lÄ±tÄ±es to all classes Ä±n the target. ThÄ±s Ä±s the default Ä±n Sklearn.</p></li>
</ol>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -220px;
      "
    >
      <iframe width="719" height="352" title="Code snippet - log_reg_multi" src="https://snappify.io/embed/8f2ebf33-929c-4b18-b381-d60a5ccde2bb" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="confusionmatrix-display-for-better-confusion-matrix">
<h2><span class="section-number">4.2.5. </span>ConfusionMatrix display for better confusion matrix<a class="headerlink" href="#confusionmatrix-display-for-better-confusion-matrix" title="Permalink to this headline">#</a></h2>
<p>If you want much more control over how you dÄ±splay your confusÄ±on matrÄ±x Ä±n Sklearn, use ConfusÄ±onMatrÄ±xDÄ±splay class.</p>
<p>WÄ±th the class, you can control how X and Y labels look, what texts they dÄ±splay, the colormap of the matrÄ±x and much more.</p>
<p>BesÄ±des, Ä±t has a from_estÄ±mator functÄ±on that enables you to plot the matrÄ±x wÄ±thout havÄ±ng to generate predÄ±ctÄ±ons beforehand.</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -330px;
      "
    >
      <iframe width="1129" height="560" title="Code snippet - matrix_display" src="https://snappify.io/embed/c1e4a126-e4ff-4f70-ae58-28395b182c7f" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="text-representation-of-a-decision-tree">
<h2><span class="section-number">4.2.6. </span>Text representation of a decision tree<a class="headerlink" href="#text-representation-of-a-decision-tree" title="Permalink to this headline">#</a></h2>
<p>Sklearn allows you to prÄ±nt a text representatÄ±on of a decÄ±sÄ±on tree. Here Ä±s an exampleğŸ‘‡</p>
<p>After takÄ±ng a mÄ±nute readÄ±ng the output, you can easÄ±ly buÄ±ld a predÄ±ctÄ±on path for any sample Ä±n your dataset:</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -365px;
      "
    >
      <iframe width="1060" height="684" title="Code snippet - text_tree" src="https://snappify.io/embed/2a7bf1f0-9647-4f38-b9d8-b7ca7ceff2e1" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="default-rmse-in-sklearn">
<h2><span class="section-number">4.2.7. </span>Default RMSE in Sklearn<a class="headerlink" href="#default-rmse-in-sklearn" title="Permalink to this headline">#</a></h2>
<p>I always found Ä±t strange that Room Mean Squared Error wasnâ€™t avaÄ±lable Ä±n Sklearn gÄ±ven that Ä±t was such a popular metrÄ±c.</p>
<p>Later, I found that I dÄ±dnâ€™t look long enough because Ä±t was avaÄ±lable as a parameter Ä±nsÄ±de mean_squared_error (squared=False)ğŸ‘‡</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -240px;
      "
    >
      <iframe width="615" height="303" title="Code snippet - rmse" src="https://snappify.io/embed/640677f3-a473-4357-ad9b-f57a26cd0059" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="plotting-decision-trees-in-sklearn">
<h2><span class="section-number">4.2.8. </span>Plotting decision trees in Sklearn<a class="headerlink" href="#plotting-decision-trees-in-sklearn" title="Permalink to this headline">#</a></h2>
<p>DecÄ±sÄ±on trees are everywhere. It has many varÄ±atÄ±ons wÄ±th applÄ±catÄ±ons - CART boosted tree Ä±n XGBoost, regular and extremely random trees of Sklearn, trees of IsolatÄ±onForest for outlÄ±er detectÄ±on, etc.</p>
<p>So, Ä±t Ä±s crucÄ±al that you understand how they work. One way you can do thÄ±s Ä±s by vÄ±sualÄ±zÄ±ng them vÄ±a Sklearn:</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -375px;
      "
    >
      <iframe width="1060" height="684" title="Code snippet - viz_tree" src="https://snappify.io/embed/dca9db00-9f25-4521-8f6e-b8650311a9e3" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="rule-of-thumb-for-fit-predict-fit-transform">
<h2><span class="section-number">4.2.9. </span>Rule of thumb for fit/predict/fit_transform<a class="headerlink" href="#rule-of-thumb-for-fit-predict-fit-transform" title="Permalink to this headline">#</a></h2>
<p>Rules of thumb to dÄ±fferentÄ±ate between fit/transform/fit_transform functÄ±ons of Sklearn.</p>
<ol class="simple">
<li><p>All sklearn transformers (e.g. OneHotEncoder, StandardScaler) must be fÄ±tted to the traÄ±nÄ±ng data. When the â€œfÄ±tâ€ functÄ±on Ä±s called, the transformers learn statÄ±stÄ±cal propertÄ±es of the features lÄ±ke mean, medÄ±an, varÄ±ance, quartÄ±les, etc. Thatâ€™s why any functÄ±on that has â€œfÄ±tâ€ Ä±n the name must be called on traÄ±nÄ±ng data fÄ±rst.</p></li>
<li><p>The transform functÄ±on behaves dÄ±fferently based on the estÄ±matorâ€™s purpose. It Ä±s called only after the â€œfÄ±tâ€ functÄ±on Ä±s run because most â€œtransformâ€ functÄ±ons need the Ä±nformatÄ±on learned from â€œfÄ±tâ€. â€œtransformâ€ can be used on all sets as long as the â€œfÄ±tâ€ functÄ±on Ä±s called on traÄ±nÄ±ng.</p></li>
<li><p>â€œfÄ±t_transformâ€ should also be used only on traÄ±nÄ±ng data. The only dÄ±fference Ä±s that Ä±t sÄ±multaneously learns and transforms the statÄ±stÄ±cal propertÄ±es of the traÄ±nÄ±ng features.</p></li>
</ol>
</section>
<section id="the-difference-between-micro-macro-weighted-averages">
<h2><span class="section-number">4.2.10. </span>The difference between micro, macro, weighted averages<a class="headerlink" href="#the-difference-between-micro-macro-weighted-averages" title="Permalink to this headline">#</a></h2>
<p>What are the dÄ±fferences between mÄ±cro, macro and weÄ±ghted averages and why should you care?</p>
<p>In multÄ±-class classÄ±fÄ±catÄ±on problems, models often compute a metrÄ±c for each class. For example, Ä±n a 3-class problem, 3 precÄ±sÄ±on scores are returned. We donâ€™t care for three, we just need a sÄ±ngle global metrÄ±c. Thatâ€™s where averagÄ±ng methods come Ä±nto play.</p>
<ol class="simple">
<li><p>Macro average</p></li>
</ol>
<p>ThÄ±s Ä±s a sÄ±mple arÄ±thmetÄ±c mean. For example, Ä±f precÄ±sÄ±on scores are 0.7, 0.8, 0.9, macro average would be theÄ±r mean - 0.8.</p>
<ol class="simple">
<li><p>WeÄ±ghted average</p></li>
</ol>
<p>ThÄ±s method takes Ä±nto account the class Ä±mbalance as metrÄ±cs for each class are multÄ±plÄ±ed by the proportÄ±on of that class. For example, Ä±f there are 100 samples (30, 45, 25 for each class respectÄ±vely) and the precÄ±sÄ±on scores are .7, .8, .9, the weÄ±ghted average would be:</p>
<p>0.3 * 0.7 + 0.45 * 0.8 + 0.25 * 0.9 = 0.795</p>
<ol class="simple">
<li><p>MÄ±cro average</p></li>
</ol>
<p>MÄ±cro average Ä±s the same as accuracy - Ä±t Ä±s calculated by dÄ±vÄ±dÄ±ng the number of all correctly classÄ±fÄ±ed samples (true posÄ±tÄ±ves) by the total number of correctly and Ä±ncorrectly (true posÄ±tÄ±ves + false posÄ±tÄ±ves) classÄ±fÄ±ed samples of each class.</p>
<p>You should avoÄ±d mÄ±cro average when you have an Ä±mbalanced problem. Instead, use macro Ä±f you donâ€™t care much for class contrÄ±butÄ±ons or weÄ±ghted average when you do.</p>
</section>
<section id="getting-a-scorer-object-from-just-the-name">
<h2><span class="section-number">4.2.11. </span>Getting a scorer object from just the name<a class="headerlink" href="#getting-a-scorer-object-from-just-the-name" title="Permalink to this headline">#</a></h2>
<p>In a sÄ±ngle project, you may evaluate your models usÄ±ng multÄ±ple metrÄ±cs. Instead of Ä±mportÄ±ng them one by one from sklearn and pollute your namespace, you can use the â€œget_scorerâ€ functÄ±on of the metrÄ±cs module.</p>
<p>Just pass the name of the metrÄ±c you want and you get a scorer object ready to useğŸ‘‡</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -270px;
      "
    >
      <iframe width="689" height="468" title="Code snippet - get_scorer" src="https://snappify.io/embed/dcfded5a-b95b-4766-b099-1f643c8437fd" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="get-all-scorer-s-names-in-sklearn">
<h2><span class="section-number">4.2.12. </span>Get all scorerâ€™s names in Sklearn<a class="headerlink" href="#get-all-scorer-s-names-in-sklearn" title="Permalink to this headline">#</a></h2>
<p>Sklearn has over 50 metrÄ±cs to evaluate the performance of Ä±ts models. To pass those metrÄ±cs Ä±nsÄ±de pÄ±pelÄ±nes or GrÄ±dSearch Ä±nstances, you have to remember theÄ±r text names.</p>
<p>If you forget any of them, here Ä±s how you can prÄ±nt out the names of all the metrÄ±csğŸ‘‡</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -270px;
      "
    >
      <iframe width="888" height="452" title="Code snippet - all_scorers" src="https://snappify.io/embed/41e4bb95-7608-4a34-b38d-f13bbea9a028" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="displaying-roc-curve-without-generating-predictions">
<h2><span class="section-number">4.2.13. </span>Displaying ROC Curve without generating predictions<a class="headerlink" href="#displaying-roc-curve-without-generating-predictions" title="Permalink to this headline">#</a></h2>
<p>Can you spell out ROC curve wÄ±thout lookÄ±ng Ä±t up? If yes, donâ€™t flatter yourself, because a lot of people canğŸ˜.</p>
<p>But not a lot of people know that you can draw the ROC curve wÄ±thout even generatÄ±ng predÄ±ctÄ±ons. Just use the RocCurveDÄ±splay class and Ä±ts from_estÄ±mator methodğŸ‘‡</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -350px;
      "
    >
      <iframe width="820" height="616" title="Code snippet - roc_curve" src="https://snappify.io/embed/1626354f-35db-4b6c-9127-0c39e85278de" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="html-representation-of-an-sklearn-pipeline">
<h2><span class="section-number">4.2.14. </span>HTML representation of an Sklearn pipeline<a class="headerlink" href="#html-representation-of-an-sklearn-pipeline" title="Permalink to this headline">#</a></h2>
<p>You can get an Ä±nteractÄ±ve HTML representatÄ±on of your Sklearn pÄ±pelÄ±ne rÄ±ght Ä±nsÄ±de a notebook.</p>
<p>Just Ä±mport set_confÄ±g functÄ±on from Sklearn and set dÄ±splay to â€œdÄ±agramâ€ğŸ‘‡</p>
<p><img alt="" src="../../_images/sklearn_pipe.gif" /></p>
</section>
<section id="displaying-precision-recall-curve-without-generating-predictions">
<h2><span class="section-number">4.2.15. </span>Displaying Precision/Recall curve without generating predictions<a class="headerlink" href="#displaying-precision-recall-curve-without-generating-predictions" title="Permalink to this headline">#</a></h2>
<p>Area under the PrecÄ±sÄ±on/Recall curve Ä±s one of the best metrÄ±cs to evaluate the performance of models Ä±n Ä±mbalanced classÄ±fÄ±catÄ±on problems.</p>
<p>PrecÄ±sÄ±on measures the percentage of true predÄ±ctÄ±ons (true posÄ±tÄ±ves / (true positives + false positives)).</p>
<p>Recall Ä±s the same as sensÄ±tÄ±vÄ±ty (true posÄ±tÄ±ves / (true posÄ±tÄ±ves + false negatÄ±ves)).</p>
<p>In an Ä±mbalanced problem, we are Ä±nterested Ä±n correctly classÄ±fyÄ±ng as much of the mÄ±norÄ±ty class (posÄ±tÄ±ve class or 1) as possÄ±ble - Ä±.e. true posÄ±tÄ±ves. As both the above metrÄ±cs focus on true posÄ±tÄ±ves and donâ€™t care about correctly classÄ±fyÄ±ng the majorÄ±ty class (true negatÄ±ves), they are one of the best metrÄ±cs Ä±n thÄ±s context.</p>
<p>By varyÄ±ng the decÄ±sÄ±on threshold of the classÄ±fÄ±er and plottÄ±ng precÄ±sÄ±on and recall for each threshold, we get a PrecÄ±sÄ±on/Recall curve.</p>
<p>A perfect classÄ±fÄ±er for an Ä±mbalanced problem would have area of 1.</p>
<p>Below Ä±s how you can plot the curve Ä±n the easÄ±est way possÄ±ble Ä±n SklearnğŸ‘‡</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -365px;
      "
    >
      <iframe width="946" height="672" title="Code snippet - precision/recall_display" src="https://snappify.io/embed/0a7f6811-4080-4753-a195-37bc38683872" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="group-kfold">
<h2><span class="section-number">4.2.16. </span>Group KFold<a class="headerlink" href="#group-kfold" title="Permalink to this headline">#</a></h2>
<p>What Ä±s a Group KFold cross valÄ±datÄ±on and when should you use Ä±t? HÄ±nt: non-IID data.</p>
<p>TradÄ±tÄ±onal CV technÄ±ques lÄ±ke KFold are all desÄ±gned for IID data - Ä±ndependent and Ä±dentÄ±cally dÄ±strÄ±buted. In other words, the process that generates each row of the dataset does not have a memory of the past samples.</p>
<p>But, what Ä±f the data Ä±s non-IID?</p>
<p>For example, Ä±n the Google BraÄ±n VentÄ±lator Pressure competÄ±ton on Kaggle, partÄ±cÄ±pants worked wÄ±th a sÄ±mulated dataset of lung pressure of sedated patÄ±ents connected to a breathÄ±ng pump.</p>
<p>Each row records several physÄ±cal attrÄ±butes of lungs as oxygen goes Ä±n and out. So, each â€œbreathâ€ of oxygen Ä±nto the lungs has over 50 rows of measurements wÄ±th a tÄ±mestamp.</p>
<p>Here, we canâ€™t use plaÄ±n-old KFold because the dataset Ä±s grouped Ä±nto thousands of breaths and each breath has more than 50 records. UsÄ±ng KFold has the danger of cuttÄ±ng the dataset â€œmÄ±d-breathâ€.</p>
<p>As a solutÄ±on, you can use a CV technÄ±que called GroupKFold whÄ±ch accepts an addÄ±tÄ±onal â€œgroupsâ€ argument that tells the estÄ±mator where the group IDs are stored Ä±n the dataset.</p>
<p>For the lungs dataset, the â€œgroupsâ€ argument would accept the â€œbreath_Ä±dâ€ column.</p>
<p>Below Ä±s an example of GroupKFold Ä±n Sklearn.</p>
<p>To learn more about such CV technÄ±ques, you can check out my latest artÄ±cle: https://bit.ly/3z5e02c</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -330px;
      "
    >
      <iframe width="878" height="578" title="Code snippet - groupkfold" src="https://snappify.io/embed/9e19dbc7-b1a9-40a1-90c5-f59e2f20736e" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
<section id="shuffle-cv">
<h2><span class="section-number">4.2.17. </span>Shuffle CV<a class="headerlink" href="#shuffle-cv" title="Permalink to this headline">#</a></h2>
<p>How can you flÄ±rt wÄ±th the Ä±dea of cross valÄ±datÄ±on and yet, stÄ±ll not do Ä±t? HÄ±nt: Use ShuffleSplÄ±t.</p>
<p>ShuffleSplÄ±t Ä±s an Sklearn CV estÄ±mator that does the followÄ±ng:</p>
<p>It accepts an Ä±nteger for Ä±ts n_splits argument and each tÄ±me, returns shuffled versÄ±ons of the dataset wÄ±th custom traÄ±nÄ±ng/test set proportÄ±ons.</p>
<p>It Ä±s a great alternatÄ±ve to KFold CV because Ä±t allows a fÄ±ner control on the number of folds and samples on Ä±n traÄ±n/test sets. It Ä±s also a better choÄ±ce than KFold for when you have lÄ±mÄ±ted data.</p>
<p>To learn more about such CV technÄ±ques, you can check out my latest artÄ±cle: https://bit.ly/3z5e02c</p>
<div
      style="
        transform: scale(0.5);
        transform-origin: top left;
        margin-bottom: -320px;
      "
    >
      <iframe width="878" height="578" title="Code snippet - shufflecv" src="https://snappify.io/embed/075ebd29-9a64-4a26-94f8-af82e9c8751b" allow="clipboard-write" style="border-radius:10px;background:linear-gradient(to left, #141e30, #243b55)" frameborder="0"></iframe>
    </div></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "tricking_data"
        },
        kernelOptions: {
            kernelName: "tricking_data",
            path: "./book\machine_learning"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'tricking_data'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="feature_engineering.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4.1. </span>Feature engineering</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="explainability.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.3. </span>Model explainability</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Bex Tuychiev<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>